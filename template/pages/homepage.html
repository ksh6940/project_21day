<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
    <title>21Day Project</title>
    <link rel="stylesheet" href="/template/static/css/homepage.css">
    <script src="/template/static/scripts/DdayCaculater.js"></script>
    <script src="/template/static/scripts/tableAPI.js"></script>
    <link rel="icon" href="/template/static/img/calendar.png" type="image/png" />
    <meta name="description" content="21Day Project: 21ì¼ê°„ ëª©í‘œ ë‹¬ì„±ì„ ë•ëŠ” ì¼ì • ë° ê³„íš ê´€ë¦¬ ì›¹ì‚¬ì´íŠ¸">
    <meta name="keywords" content="21day project, ëª©í‘œê´€ë¦¬, ê³µë¶€ê³„íš, ì¼ì •, D-day, í•™ìŠµê´€ë¦¬">
    <meta name="author" content="seogo">
    <meta property="og:title" content="21Day Project" />
    <meta property="og:description" content="21ì¼ê°„ ëª©í‘œ ë‹¬ì„±ì„ ë•ëŠ” ì¼ì • ë° ê³„íš ê´€ë¦¬ ì›¹ì‚¬ì´íŠ¸" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="21Day Project" />
    <meta name="twitter:description" content="21ì¼ê°„ ëª©í‘œ ë‹¬ì„±ì„ ë•ëŠ” ì¼ì • ë° ê³„íš ê´€ë¦¬ ì›¹ì‚¬ì´íŠ¸" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
</head>

<body>
    <div class="header">
        <div class="title">
            <i class="bx bx-badge-check"></i>
            <h3><a href="/">21Day Project</a></h3>
        </div>
    </div>

    <div class="main">
        <div class="goal">
            <div class="goal-content">
                <div class="goal-message">
                    <div class="goal_title">
                        <h3>My Goal</h3>
                    </div>
                    <div class="detail-goal">
                        <ul>
                            <li>ì „ ê³¼ëª© ê°œë… ê°•ì¢Œ ìˆ˜ê°• ì™„ë£Œí•˜ê¸°</li>
                            <li>ì „ ê³¼ëª© ìˆ˜ëŠ¥íŠ¹ê°• ìˆ˜ê°• ì™„ë£Œí•˜ê¸°</li>
                            <li>ë§¤ì¼ ì•„ì¹¨ êµ­ì–´ ê¸°ì¶œ 1ì„¸íŠ¸ í’€ê¸°</li>
                            <li>ìˆ˜í•™ 4ì  ê¸°ì¶œ ë¬¸ì œ í’€ê¸°</li>
                            <li>ë¯¸ì ë¶„ 2~3ì  ê¸°ì¶œ ë¬¸ì œ í’€ê¸°</li>
                            <li>ë§¤ì¼ ì˜ì–´ ì–´íœ˜ 30ê°œ ì•”ê¸°í•˜ê¸°</li>
                            <li>ê²©ì¼ë¡œ ì˜ì–´ ë“£ê¸° 1ì„¸íŠ¸ í’€ê¸°</li>
                        </ul>
                    </div>
                </div>
                <div class="goal-Dday">
                    <div class="goal-Dday-title">
                        <h3>D-Day</h3>
                    </div>
                    <div class="dday-list">
                        <div class="dday-item">
                            <span>ëŒ€í•™ìˆ˜í•™ëŠ¥ë ¥ì‹œí—˜</span>
                            <span id="korean-sat">ê³„ì‚° ì¤‘..</span>
                        </div>
                        <div class="dday-item">
                            <span>9ì›” ëª¨ì˜í‰ê°€</span>
                            <span id="september-sat">ê³„ì‚° ì¤‘..</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="calendar-Wrap">
            <div class="calendar_title">
                <h3>Daily Schedule</h3>
            </div>
            <div class="table">
                <table class="calendar">
                    <tr>
                        <td><div class="day" data-day="1">1</div></td>
                        <td><div class="day" data-day="2">2</div></td>
                        <td><div class="day" data-day="3">3</div></td>
                        <td><div class="day" data-day="4">4</div></td>
                        <td><div class="day" data-day="5">5</div></td>
                        <td><div class="day" data-day="6">6</div></td>
                        <td><div class="day" data-day="7">7</div></td>
                    </tr>
                    <tr>
                        <td><div class="day" data-day="8">8</div></td>
                        <td><div class="day" data-day="9">9</div></td>
                        <td><div class="day" data-day="10">10</div></td>
                        <td><div class="day" data-day="11">11</div></td>
                        <td><div class="day" data-day="12">12</div></td>
                        <td><div class="day" data-day="13">13</div></td>
                        <td><div class="day" data-day="14">14</div></td>
                    </tr>
                    <tr>
                        <td><div class="day" data-day="15">15</div></td>
                        <td><div class="day" data-day="16">16</div></td>
                        <td><div class="day" data-day="17">17</div></td>
                        <td><div class="day" data-day="18">18</div></td>
                        <td><div class="day" data-day="19">19</div></td>
                        <td><div class="day" data-day="20">20</div></td>
                        <td><div class="day" data-day="21">21</div></td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="analysis">
            <div class="analysis_title">
                <h3>Plan Analysis</h3>
            </div>
            <div class="result">
                <div class="progressbar">
                    <p>ê³„íš ì´í–‰ë¥ </p>
                    <progress class="progress-bar" id="progress" value="50" max="100"></progress>
                </div>
                <div class="stats"></div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const totalPlans = 21;
            const completedDays = {{ completed_days | tojson | default('[]') }};
            const inProgressDays = {{ in_progress_days | tojson | default('[]') }};

            const completedCount = completedDays.length;
            const inProgressCount = inProgressDays.length;
            const remainingCount = totalPlans - completedCount - inProgressCount;
            const progressPercent = totalPlans > 0 ? Math.round((completedCount / totalPlans) * 100) : 0;

            const progressBar = document.getElementById('progress');
            if (progressBar) {
                progressBar.value = progressPercent;
                progressBar.max = 100;
            }

            const statsElem = document.querySelector('.stats');
            if (statsElem) {
                statsElem.innerHTML = `
                    <p>ì´ ëª©í‘œ ìˆ˜: <strong>${totalPlans}ê°œ</strong></p>
                    <p>ì™„ë²½ ë‹¬ì„± ëª©í‘œ ìˆ˜: <strong>${completedCount}ê°œ</strong></p>
                    <p>ì§„í–‰ ì¤‘ ëª©í‘œ ìˆ˜: <strong>${inProgressCount}ê°œ</strong></p>
                    <p>ë‚¨ì€ ëª©í‘œ ìˆ˜: <strong>${remainingCount}ê°œ</strong></p>
                `;
            }

            completedDays.forEach(dayNum => {
                const dayElem = document.querySelector(`.day[data-day="${dayNum}"]`);
                if (dayElem) {
                    fetch(`/getStudyTime?day=${dayNum}`)
                        .then(res => res.json())
                        .then(data => {
                            const st = data.studyTime || { hours: '0', minutes: '0' };
                            dayElem.textContent = `${st.hours}ì‹œê°„ ${st.minutes}ë¶„ âœ…`;
                            dayElem.title = 'ì™„ë²½ ë‹¬ì„±ëœ ë‚ ';
                        })
                        .catch(err => console.error(`Failed to fetch study time for day ${dayNum}:`, err));
                }
            });

            inProgressDays.forEach(dayNum => {
                const dayElem = document.querySelector(`.day[data-day="${dayNum}"]`);
                if (dayElem) {
                    fetch(`/getStudyTime?day=${dayNum}`)
                        .then(res => res.json())
                        .then(data => {
                            const st = data.studyTime || { hours: '0', minutes: '0' };
                            dayElem.textContent = `${st.hours}ì‹œê°„ ${st.minutes}ë¶„ ğŸ”„`;
                            dayElem.title = 'ì§„í–‰ ì¤‘ì¸ ë‚ ';
                        })
                        .catch(err => console.error(`Failed to fetch study time for day ${dayNum}:`, err));
                }
            });
        });
    </script>

    <!-- ğŸŸ¢ ì´ ì•„ë˜ì— ê³„íš ì¶”ê°€/ì‚­ì œ ê´€ë ¨ JSë¥¼ ì—°ê²°í•˜ë©´ ë©ë‹ˆë‹¤ -->
    <script src="/template/static/scripts/CreateScheduler.js"></script>
    <script src="/template/static/scripts/tableAPI.js"></script>
    <script src="/template/static/scripts/DdayCaculater.js"></script>
</body>

</html>
